language: node_js
node_js:
  - "0.10"
services:
  - selenium
# addons:
  # firefox: "17.0"
  
build: 
  ci:
  - export DISPLAY=:99.0
  # - /etc/init.d/xvfb start
  - curl -o /tmp/chromedriver.zip -L http://chromedriver.storage.googleapis.com/2.10/chromedriver_linux64.zip
  - unzip /tmp/chromedriver.zip -d /home/shippable/bin
  - chmod +x /home/shippable/bin/chromedriver
  - echo '#!/bin/bash' | sudo tee /usr/bin/google-chrome
  - echo 'exec /usr/bin/chrome --no-sandbox --disable-gpu \"$@\"' | sudo tee -a /usr/bin/google-chrome
  - sudo chmod +x /usr/bin/google-chrome
  - which chromedriver
  - sudo npm install
  - xvfb-run --server-args="-ac" npm test
